<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creta - Gestión de Reservas</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/frappe-charts@1.2.4/dist/frappe-charts.min.iife.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fuente Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body class="text-slate-600 flex flex-col min-h-screen">

    <!-- HEADER NAVIGATION -->
    <nav class="border-b-8 border-red-500" style="background-color: rgb(28, 25, 23);">
        <div class="flex flex-wrap items-center justify-between px-4 py-2">
            <!-- Logo -->
            <div class="flex items-center gap-4">
                <a href="https://public.digitalvalue.es/github/zity-components-m/src/apps/">
                    <img src="https://cdn.digitalvalue.es/alcantir/assets/5cc03ffd1d8c420100aa90fe?w=300" alt="Logo"
                        class="h-5 w-auto opacity-70 hover:opacity-100 transition">
                </a>
                <a href="https://public.digitalvalue.es/github/zity-components-m/src/apps/"
                    class="text-white text-sm opacity-70 hover:opacity-100 transition hidden sm:block">
                    Panell de Serveis
                </a>
                <a href="#!./" class="text-white text-sm font-medium">
                    CRETA. Citas, Reservas, Entradas, Turnos y Autorizaciones
                </a>
            </div>

            <!-- Right Menu -->
            <div class="flex items-center gap-2 flex-wrap">
                <div class="text-white text-sm px-3 py-2">admin.pinto</div>
                <div class="text-white text-sm px-3 py-2">pinto</div>
                <button
                    class="bg-transparent border border-white text-white px-3 py-2 rounded hover:bg-white hover:bg-opacity-10 transition">
                    <i class="fa-solid fa-user text-green-500"></i>
                </button>
                <div class="relative group">
                    <button
                        class="bg-transparent border border-white text-white px-3 py-2 rounded hover:bg-white hover:bg-opacity-10 transition flex items-center gap-2">
                        <span class="text-sm">VA</span>
                        <i class="fa-solid fa-globe"></i>
                    </button>
                    <!-- Dropdown (hidden by default) -->
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg hidden group-hover:block z-50">
                        <a href="#" class="flex items-center gap-3 px-4 py-2 hover:bg-slate-100 transition">
                            <img src="../assets/espana.png" alt="Castellano" class="w-5 h-5 object-contain">
                            <span class="text-slate-700">Castellano</span>
                        </a>
                        <a href="#" class="flex items-center gap-3 px-4 py-2 hover:bg-slate-100 transition">
                            <img src="../assets/english.png" alt="English" class="w-5 h-5 object-contain">
                            <span class="text-slate-700">English</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- TOP NAVIGATION (Común) -->
    <!-- TOP NAVIGATION REMOVED -->

    <!-- APP CONTAINER -->
    <div id="app-container" class="flex-grow max-w-8xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8">

        <!-- VISTA 1: DASHBOARD PRINCIPAL (Lista de recursos) -->
        <div id="view-dashboard" class="fade-in">
            <!-- Page Header -->
            <div class="mb-8">
                <h1 class="text-3xl font-bold text-slate-900 tracking-tight">Cita previa y Reservas</h1>
                <p class="mt-2 text-lg text-slate-500 max-w-3xl">
                    Gestiona las reservas y citas con el personal del ayuntamiento.
                </p>
            </div>

            <!-- Toolbar / Filters -->
            <div
                class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 mb-8 flex flex-col xl:flex-row gap-4 justify-between items-center">
                <!-- Search -->
                <div class="flex flex-col sm:flex-row gap-4 w-full xl:w-auto flex-grow">
                    <div class="relative w-full sm:w-72 xl:w-96">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fa-solid fa-magnifying-glass text-slate-400"></i>
                        </div>
                        <input type="text" id="search-input" onkeyup="app.filterResources()"
                            class="block w-full pl-10 pr-3 py-2 border border-slate-300 rounded-lg leading-5 bg-white placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm transition"
                            placeholder="Busca grupos o recursos...">
                    </div>

                    <!-- Type Filters -->
                    <div class="flex items-center space-x-2 overflow-x-auto no-scrollbar pb-1 sm:pb-0">
                        <button onclick="app.setFilterType('all')" id="btn-filter-all"
                            class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium bg-blue-600 text-white transition-colors border border-blue-600">
                            Todos
                        </button>
                        <button onclick="app.setFilterType('booking')" id="btn-filter-booking"
                            class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium bg-white text-slate-600 hover:bg-slate-50 border border-slate-200 transition-colors">
                            Reservas
                        </button>
                        <button onclick="app.setFilterType('bon')" id="btn-filter-bon"
                            class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium bg-white text-slate-600 hover:bg-slate-50 border border-slate-200 transition-colors">
                            Bonos
                        </button>
                        <button onclick="app.setFilterType('appointment')" id="btn-filter-appointment"
                            class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium bg-white text-slate-600 hover:bg-slate-50 border border-slate-200 transition-colors">
                            Citas
                        </button>
                    </div>
                </div>

                <!-- Actions Toolbar -->
                <div class="flex flex-wrap items-center gap-3 justify-center xl:justify-end w-full xl:w-auto">

                    <!-- Navigation Links -->
                    <div class="flex items-center bg-slate-50 rounded-lg p-1 border border-slate-200">
                        <a href="#!/kiosko"
                            class="px-3 py-1.5 rounded-md text-sm font-medium text-slate-600 hover:text-blue-600 hover:bg-white hover:shadow-sm transition-all whitespace-nowrap"
                            title="Kiosko">
                            <i class="fa-solid fa-ticket mr-1.5"></i> Kiosko
                        </a>
                        <a href="./citaprevia_web.html" target="_blank"
                            class="px-3 py-1.5 rounded-md text-sm font-medium text-slate-600 hover:text-blue-600 hover:bg-white hover:shadow-sm transition-all whitespace-nowrap"
                            title="Web">
                            <i class="fa-solid fa-globe mr-1.5"></i> Web
                        </a>
                        <a href="#!/tv"
                            class="px-3 py-1.5 rounded-md text-sm font-medium text-slate-600 hover:text-blue-600 hover:bg-white hover:shadow-sm transition-all whitespace-nowrap"
                            title="TV">
                            <i class="fa-solid fa-tv mr-1.5"></i> TV
                        </a>
                        <a href="#!/stats"
                            class="px-3 py-1.5 rounded-md text-sm font-medium text-slate-600 hover:text-blue-600 hover:bg-white hover:shadow-sm transition-all whitespace-nowrap"
                            title="Estadísticas">
                            <i class="fa-solid fa-chart-bar mr-1.5"></i> Stats
                        </a>
                    </div>

                    <div class="h-8 w-px bg-slate-200 mx-1"></div>

                    <!-- Toggle Unpublished -->
                    <label
                        class="flex items-center cursor-pointer select-none bg-slate-50 px-3 py-2 rounded-lg border border-slate-200 hover:bg-slate-100 transition-colors"
                        title="Mostrar No Publicados">
                        <div class="relative">
                            <input type="checkbox" id="toggle-unpublished" class="sr-only peer"
                                onchange="app.renderDashboard()">
                            <div
                                class="block bg-slate-300 w-8 h-5 rounded-full peer-checked:bg-blue-600 transition-colors">
                            </div>
                            <div
                                class="absolute left-1 top-1 bg-white w-3 h-3 rounded-full transition-transform peer-checked:translate-x-full">
                            </div>
                        </div>
                        <!-- <span class="ml-2 text-sm font-medium text-slate-600">Ocultos</span> -->
                    </label>

                    <!-- Settings Button -->
                    <button
                        class="bg-white border border-slate-200 text-slate-600 hover:text-blue-600 hover:border-blue-300 hover:bg-blue-50 px-3 py-2 rounded-lg transition-all shadow-sm"
                        title="Ajustes">
                        <i class="fa-solid fa-gear"></i>
                    </button>

                    <!-- Add Button -->
                    <button
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm flex items-center transition-all hover:shadow-md">
                        <span>Añadir</span>
                        <i class="fa-solid fa-plus ml-2"></i>
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading-indicator" class="text-center py-12 hidden">
                <i class="fa-solid fa-circle-notch fa-spin text-4xl text-blue-600"></i>
                <p class="mt-4 text-slate-500">Cargando recursos...</p>
            </div>

            <!-- MASONRY GRID CONTAINER -->
            <div id="resources-grid" class="masonry-grid pb-12">
                <!-- El contenido se inyectará aquí vía JS -->
            </div>
        </div>

        <!-- VISTA 2: DETALLE DEL RECURSO (Oculta por defecto) -->
        <div id="view-detail" class="hidden fade-in">
            <!-- Action Header -->
            <div
                class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8 bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                <div class="flex items-center gap-4">
                    <!-- Botón Volver -->
                    <button onclick="app.goHome()"
                        class="group flex items-center justify-center w-10 h-10 rounded-full bg-slate-100 text-slate-500 hover:bg-slate-200 hover:text-slate-800 transition-all"
                        title="Volver al listado">
                        <i class="fa-solid fa-arrow-left group-hover:-translate-x-1 transition-transform"></i>
                    </button>
                    <div>
                        <div class="text-xs font-bold text-blue-600 uppercase tracking-wide" id="detail-group-name">
                            Grupo</div>
                        <h1 class="text-3xl font-bold text-slate-900 leading-none" id="detail-resource-name">Nombre
                            Recurso</h1>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button
                        class="flex items-center gap-2 px-4 py-2 bg-white border border-slate-300 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-blue-600 transition-colors font-medium text-sm">
                        <i class="fa-solid fa-circle-question text-blue-500"></i>
                        <span>Ayuda</span>
                    </button>
                </div>
            </div>

            <!-- DETAIL DASHBOARD GRID (Tarjetas de acción) -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6">

                <!-- Card: Sala d'espera -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-user text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">Sala
                        d'espera</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Pantalla d'espera on es mostren els torns
                        atenent-se o per atendre</p>
                </a>

                <!-- Card: Administrador de torns -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-key text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Administrador de torns</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Pantalla per al funcionari, gestiona les reserves
                        i aten les cites</p>
                </a>

                <!-- Card: Sol·licitud de torns -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-ticket text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Sol·licitud de torns</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Pantalla per al kiosk, torna sempre la cita més
                        próxima</p>
                </a>

                <!-- Card: Solicitud de turnos 2 -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-ticket-simple text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Solicitud de turnos 2</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Pantalla per al kiosk, es possible seleccionar el
                        dia</p>
                </a>

                <!-- Card: Calendari -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-calendar-days text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Calendari</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Calendari on es mostren les cites o es gestionen
                        els horaris</p>
                </a>

                <!-- Card: Panell de comandaments -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-table-columns text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">Panell
                        de comandaments</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Mostra totes les cites i el seu estat</p>
                </a>

                <!-- Card: Administració -->
                <div onclick="app.loadAdminView()"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full cursor-pointer">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-pen-to-square text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Administració</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Administra els ajustos, imprimeix reserves, cerca
                        cites...</p>
                </div>

                <!-- Card: Selecció -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-arrow-pointer text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Selecció</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Torna al menú on es mostren tots els recursos</p>
                </a>

                <!-- Card: Lector de QR -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-qrcode text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">Lector
                        de QR</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Lector de QR, para confirmar la llegada de la
                        persona al centro o comprobar saldo del bono</p>
                </a>

                <!-- Card: Citaprevia web -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-globe text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">
                        Citaprevia web</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Pàgina web oberta al públic de la cita prèvia</p>
                </a>

                <!-- Card: App mòbil -->
                <a href="#"
                    class="group bg-white rounded-xl p-6 shadow-sm border border-slate-200 hover:shadow-lg hover:border-blue-200 hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center sm:items-start sm:text-left h-full">
                    <div
                        class="h-14 w-14 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 mb-4 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                        <i class="fa-solid fa-mobile-screen text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800 group-hover:text-blue-600 transition-colors mb-2">App
                        mòbil</h3>
                    <p class="text-sm text-slate-500 leading-relaxed">Aplicació mòvil de la cita prèvia</p>
                </a>

            </div>
        </div>

        <!-- VISTA 3: ADMINISTRACIÓN DEL RECURSO (Oculta por defecto) -->
        <div id="view-admin" class="hidden fade-in">
            <!-- El contenido se inyectará aquí vía JS -->
        </div>

        <!-- VISTA 4: CALENDARIO DE CITAS (Oculta por defecto) -->
        <div id="view-calendar" class="hidden fade-in">
            <!-- El contenido se inyectará aquí vía JS -->
        </div>

    </div>

    <!-- FOOTER -->
    <footer class="bg-gray-900 text-white px-4 py-3 flex items-center gap-3 flex-wrap mt-auto">
        <a href="https://digitalvalue.es" target="_blank" class="hover:opacity-80 transition">
            <img src="https://cdn.digitalvalue.es/digital/assets2/5ee2496c3686490100adeaca" alt="Digital Value"
                class="max-h-8">
        </a>
        <a href="http://ayuntamientoentumovil.es/" target="_blank" class="hover:opacity-80 transition">
            <img src="https://cdn.digitalvalue.es/digital/assets2/5ee2496caa0c5401004cef54"
                alt="Ayuntamiento en tu móvil" class="max-h-8">
        </a>
        <span class="ml-auto text-sm text-gray-300 flex items-center gap-2 flex-wrap">
            Gràcies per confiar en
            <a href="http://digitalvalue.es/zity.html" target="_blank" rel="nofollow noopener noreferrer"
                class="text-white hover:text-blue-400 transition">
                DIGITAL ZITY
            </a>
            <a href="mailto:info@ayuntamientoentumovil.es" rel="nofollow noopener noreferrer"
                class="text-white hover:text-blue-400 transition">
                info@ayuntamientoentumovil.es
            </a>
            <span class="text-gray-400">v2.0</span>
        </span>
    </footer>

    <!-- JAVASCRIPT APP LOGIC -->
    <script type="module" src="js/app.js"></script>
</body>

</html>